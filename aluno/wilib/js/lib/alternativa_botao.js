define(function(require){function _setConfig(config){_configEDI=config}function _popup(msg,opt){edi.util.popUp(msg,opt)}function _init(bt_botoes,callback,callbackFinal,settings){function creatMargin(margin){var $margin=margin.split(" ");return 2==$margin.length?2*parseInt($margin[1].replace("px","")):parseInt($margin[1].replace("px",""))+parseInt($margin[3].replace("px",""))}function handlerBtnClick(e){e.stopPropagation();var _this=$(this);_this.off(),_this.addClass(config.semBtn?"_btn":"btn-default-active"),peca.objetivos.length&&edi.objetivos.pop(),peca.objetivos.pop();var img;"true"==_this.attr("data-correta")?(edi.objetivos.unshift(1),config.btnBranco&&($(this).find("div").css({color:config.txtCorCerto}),config.semBtn||$(this).addClass(".btn-sem-estilo btn-sem-estilo-acertou")),config.animacao&&(img="../../canvas/objetos/animaCerto",require([img],function(canvas){var mascote=new canvas.animaCerto({width:config.animaTam,cor:config.corAnimaCerto});mascote.obj.css({left:config.animaLeft,top:config.height/2-10+config.animaTop}).appendTo(_this),mascote.play()})),callback&&callback(!0,_this)):(edi.objetivos.unshift(2),config.btnBranco&&($(this).find("div").css({color:config.txtCorErrado}),config.semBtn||$(this).addClass(".btn-sem-estilo btn-sem-estilo-errou")),config.animacao&&(img="../../canvas/objetos/animaErrado",require([img],function(canvas){var mascote=new canvas.animaErrado({width:config.animaTam,cor:config.corAnimaErrado});mascote.obj.css({left:config.animaLeft,top:config.height/2-7+config.animaTop}).appendTo(_this),mascote.play()})),callback&&callback(!1,_this)),!peca.objetivos.length&&edi.objetivos.indexOf(2)>=0?(callbackFinal&&callbackFinal(!1),edi.objetivos=[2],$(".alter-btn ._btn").off("click"),config.btnBranco&&$(".alter-btn ._btn").unbind("click")):!peca.objetivos.length&&edi.objetivos.indexOf(2)<0&&(callbackFinal&&callbackFinal(!0),$(".alter-btn ._btn").off("click"),config.btnBranco&&$(".alter-btn ._btn").unbind("click")),config.finalizar&&edi.finalizar()}edi.iniciar(_configEDI);var tempMargin,peca=this,config={width:150,height:50,left:125,top:150,randomico:!1,displayFilho:"inline-block",tamanhoTexto:25,fontSize:14,fontWeight:"bold",colunas:3,margin:"5px 5px 5px 5px",padding:"0",display:"table",btnBranco:!1,animacao:!1,animaLeft:10,animaTop:0,animaTam:42,corAnimaCerto:"#fff",corAnimaErrado:"#fff",cor:"#666",lineHeight:"none",finalizar:!0,textAlign:"center",semBtn:!1,cb:null,txtCorCerto:"#fff",txtCorErrado:"#fff"};if(settings&&$.extend(config,settings),tempMargin=config.margin,config.randomico&&bt_botoes.sort(function(){return.5-Math.random()}),!bt_botoes)return void ARR_TAREFAS[tarefaAlterBtn].resolve(config.cb);"string"==typeof config.margin&&(tempMargin=creatMargin(config.margin));var $alterBtnMain=$("<section>");return $alterBtnMain.addClass("alter-btn").attr("data-edi","alternativa_botao").css({position:"absolute",left:config.left,top:config.top,display:config.display,width:(config.width+2*tempMargin+22)*config.colunas}).appendTo("#conteudo"),bt_botoes.forEach(function(btn,i){btn.dataCorreta&&(peca.objetivos.push(0),edi.objetivos.push(0));var botao=$("<div>").addClass(config.semBtn?"_btn":config.btnBranco?"_btn btn-sem-estilo":"_btn btn btn-default").attr({id:"btn"+i,"data-correta":btn.dataCorreta}).appendTo($alterBtnMain);botao.css({position:"relative",display:"inline-block",width:config.width,height:config.height+20,margin:config.margin}).click(handlerBtnClick),$("<div>").css({position:"relative",width:config.width,height:config.height+20,verticalAlign:"middle",display:"table-cell",textAlign:config.textAlign,fontSize:config.fontSize,color:config.btnBranco?"#666":"#fff",fontWeight:config.fontWeight}).html(btn.texto).appendTo(botao)}),ARR_TAREFAS[tarefaAlterBtn].resolve(config.cb),{container:$alterBtnMain}}var tarefaAlterBtn=addTarefa(),edi=require("../lib/edi"),_configEDI=null;return{root:edi,objetivos:[],setConfig:_setConfig,alternativa_botao:_init,telaAtual:edi.util.getURL("quest"),popup:_popup}});