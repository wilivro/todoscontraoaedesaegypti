define(function(require){function _setConfig(config){_configEDI=config}function _init(input,callback,callbackFinal,config){var peca=this;edi.iniciar(_configEDI);var ultimoCaractere,caractereEquivalente,settings={corCerta:"#27ae60",corErrada:"red",corPadrao:"#666",fontBold:"normal",validarAcentos:!1,validarPontos:!1,upCaser:!1,lowerCaser:!1,cb:function(){}};config&&$.extend(settings,config),$(input).each(function(){$(this).attr("data-correta")&&(peca.objetivos.push(0),edi.objetivos.push(0))}),$(input).keyup(function(){var texto;if(settings.validarAcentos){var com_acento="áàãâäéèêëíìîïóòõôöúùûüçÁÀÃÂÄÉÈÊËÍÌÎÏÓÒÕÖÔÚÙÛÜÇ",sem_acento="aaaaaeeeeiiiiooooouuuucAAAAAEEEEIIIIOOOOOUUUUC";ultimoCaractere=$(this).val().toLowerCase().substring($(this).val().length-1,$(this).val().length),caractereEquivalente=$(this).attr("data-correta").toLowerCase().substring($(this).val().length-1,$(this).val().length);for(var i=0;i<sem_acento.length;i++)ultimoCaractere==sem_acento[i]&&caractereEquivalente==com_acento[i]&&(texto=$(this).val().substring(0,$(this).val().length-1),$(this).val(texto+caractereEquivalente))}if(settings.validarPontos){pontos=",.;:",ultimoCaractere=$(this).val().toLowerCase().substring($(this).val().length-1,$(this).val().length),caractereEquivalente=$(this).attr("data-correta").toLowerCase().substring($(this).val().length-1,$(this).val().length);for(var j=0;j<pontos.length;j++)ultimoCaractere===pontos[j]&&caractereEquivalente!==pontos[j]&&(texto=$(this).val().substring(0,$(this).val().length-1),$(this).val(texto))}var a=$(this).val().toLowerCase()===$(this).attr("data-correta").substring(0,$(this).val().length).toLowerCase()&&0!==$(this).val().length;$(this).val().toLowerCase()!==$(this).attr("data-correta").substring(0,$(this).val().length).toLowerCase()&&0!==$(this).val().length;a?$(this).css({color:settings.corPadrao}):($(this).css({color:settings.corErrada}),$(this).css({fontWeight:settings.fontBold})),a&&$(this).val().length==$(this).attr("data-correta").length&&(edi.objetivos.pop(),peca.objetivos.pop(),$(this).attr("disabled",!0).removeAttr("data-correta").css("color",settings.corCerta),settings.upCaser&&$(this).val($(this).val().toUpperCase()),settings.lowerCaser&&$(this).val($(this).val().toLowerCase()),edi.objetivos.length||(edi.finalizar(),callbackFinal&&callbackFinal($(this))),callback&&callback($(this)))}).keydown(function(){$(this).val().length==$(this).attr("data-correta").length?$(this).addClass("full"):$(this).removeClass("full")}),ARR_TAREFAS[tarefaDigita].resolve(settings.cb)}var tarefaDigita=addTarefa(),edi=require("../lib/edi"),_configEDI=null;return{objetivos:[],telaAtual:edi.util.getURL("quest"),setConfig:_setConfig,comparaTexto:_init,util:edi.util}});