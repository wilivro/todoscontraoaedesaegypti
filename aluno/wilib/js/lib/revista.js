define(function(require){function _setConfig(config){_configEDI=config}function _addPage(_text,_css,_objArr){var size=Object.keys(this.paginas).length;_objArr||(_objArr=[]);var _style={boxShadow:"",ctPadding:0,verso:{}};_css&&$.extend(_style,_css),this.paginas[size+1]={texto:_text,objects:_objArr,style:_style}}function _init(settings,callBack,callBackFinal){edi.iniciar(_configEDI);var config={elevation:50,gradients:!0,autoCenter:!1,frenteVerso:!0,width:312,height:390,left:100,top:0};settings&&$.extend(config,settings),config.width*=2;var $dv_revista=$("<div>").attr("id","revista_"+$(".revista").length).addClass("revista").css({left:config.left,top:config.top}).appendTo("#conteudo");for(var i in paginas=this.paginas){var page=paginas[i],$dv_pag=$("<div>").attr("id","pagina_"+i).addClass(page.style.capaDura?"pagina hard":"pagina").css(page.style),$pg_container=$("<div>").html(page.texto).css({padding:page.style.ctPadding}).appendTo($dv_pag);for(var j in obj=page.objects)log(obj[j]),$pg_container.append(obj[j]);$dv_pag.appendTo($dv_revista),config.frenteVerso||$("<div>").attr("id","pagina_verso_branco"+i).addClass(page.style.capaDura?"pagina hard":"pagina").css(page.style.verso).appendTo($dv_revista)}var finalizar=function(){edi.finalizar({mostrarResultado:!1})};$dv_revista.turn(config).bind("turned",function(event,page,view){callBack&&callBack(event,page,view)}).bind("last",function(event){return callBackFinal?(finalizar(),finalizar=function(){},void callBackFinal()):void($("#final").length||edi.finalizar({mostrarResultado:!1}))}),ARR_TAREFAS[tarefaRevista].resolve()}var tarefaRevista=addTarefa(),edi=require("../lib/edi"),_configEDI=null;return{objetivos:[],paginas:{},setConfig:_setConfig,addPagina:_addPage,revista:_init}});