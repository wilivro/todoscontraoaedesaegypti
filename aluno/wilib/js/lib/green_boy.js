define(function(require){function _setConfig(config){_configEDI=config}function _telaAtual(){return edi.util.getURL("quest")}function _init(texto,settings,callBack,callBackFinal){function eventosBoys(boy){boy.mouseover(function(){var $self=$(this);$self.parent().hasClass("on")||(intervalo=setInterval(function(){$self.efeito()},500))}).mouseleave(function(){clearInterval(intervalo)}).click(function(){var $self=$(this);licao.config.WIQUADRO&&Wiquadro.api.addInteration(1,$self.attr("id"),"balao"+$self.attr("data-id"),"T"),$("<div>").addClass("bloqueio").appendTo("#conteudo"),edi.regressiva(1e3*config.tempoBloqueio,"para clicar em outro boneco!",function(){$self.hasClass("ok")||(edi.objetivos.pop(),peca.objetivos.pop(),edi.finalizar(),callBack&&callBack(),0===edi.objetivos.length&&callBackFinal&&callBackFinal()),$self.addClass("on ok"),$(".bloqueio").remove()}),$(".boxBoy").removeClass("on"),$(".msg").remove();var balao=$("<div>").addClass("msg").css({width:config.widthBalao,marginLeft:-100+config.leftBalao}).appendTo($self.parent());balao.peBalao({scaleY:-1.5,scaleX:-1.5,top:149,left:120-config.leftBalao,borda:"#ccc",tamanhoBorda:12});var x=$self.parent().attr("data-id").charAt(0),y=$self.parent().attr("data-id").charAt(1);$("<div>").addClass("center").css({width:config.widthBalao}).html(texto[x][y]).appendTo(balao)})}edi.iniciar(_configEDI),_configEDI.qtdTelas=edi.qtdTelas;var intervalo,peca=this,config={top:280,qtdLinhas:2,arrQtdBoy:[1,2],widthBalao:400,leftBalao:0,distancia:25,inverter:!0,tempoBloqueio:5};settings&&$.extend(config,settings);var ctAll=$("<section>").attr("id","ctAll").css({position:"absolute",top:config.top}).appendTo("#conteudo");$.fn.efeito=function(){var $self=$(this);$self.find(".clone").length<1&&$self.clone().addClass("clone").css({position:"absolute",marginLeft:-42}).appendTo($self.parent());var $clone=$self.parent().find(".clone");$clone.animate({width:63,height:90,marginLeft:-52,marginTop:-15,opacity:0},500,function(){$clone.remove()})};for(var index=config.qtdLinhas,iLinhas=0;iLinhas<config.qtdLinhas;iLinhas++){index+=config.inverter?-1:1;for(var linhas=$("<div>").addClass("linha").css({top:(0===iLinhas?0:config.distancia*iLinhas)*(config.inverter?-1:1),zIndex:index}).appendTo(ctAll),iBoy=0;iBoy<config.arrQtdBoy[iLinhas];iBoy++){edi.objetivos.push(0),peca.objetivos.push(0);var boxBoy=$("<div>").attr({id:"boxBoy"+iLinhas+iBoy,"data-id":""+iLinhas+iBoy}).addClass("boxBoy").appendTo(linhas),boy=$("<img>").addClass("boy").attr({src:"../wilib/img/svg/green_boy.svg"}).appendTo(boxBoy);eventosBoys(boy)}}ARR_TAREFAS[tarefaAlternativa].resolve()}var tarefaAlternativa=addTarefa(),edi=require("../lib/edi"),_configEDI=null;return{root:edi,objetivos:[],setConfig:_setConfig,green_boy:_init,telaAtual:_telaAtual}});