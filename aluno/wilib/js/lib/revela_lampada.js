define(function(require){function _setConfig(config){_configEDI=config}function _init(rev,cb,cbfinal,opt){function handlerClick(){var $self=$(this),$revela=$(".revela");$revela.each(function(i,data){$self.attr("data-revela")==$(data).attr("data-revela")&&($(data).fadeIn(),cb&&cb($self,$(data)),edi.objetivos.unshift(1),edi.objetivos.pop(),peca.objetivos.pop(),0===peca.objetivos.length&&cbfinal&&cbfinal(),edi.finalizar(),$self.off())})}edi.iniciar(_configEDI);var peca=this,config={width:200,left:0,top:70,margin:10,textAlign:"center",fontSize:12,fontColor:"#666",fontWeight:"bold",tempoBloqueio:1e3,efeito:"fade",delay:0};opt&&$.extend(config,opt),rev.forEach(function(){peca.objetivos.push(0),edi.objetivos.push(0)});var $revela_lampada=$("<section>").addClass("revela-lampada").attr("data-edi","revela-lampada").css({width:790,height:315,position:"absolute",left:config.left,top:config.top}).appendTo("#conteudo");rev.forEach(function(data,i){var $revelaBox=$("<div>").addClass("revela-box").css({width:config.width,height:300,margin:config.margin,"float":"left",position:"relative"}).appendTo($revela_lampada);require(["../../canvas/objetos/animaLampada"],function(canvas){var anima=new canvas.lampada;anima.obj.appendTo($revelaBox),anima.obj.addClass("btnRev").attr("data-revela",i).css({position:"absolute",left:config.width/2-60,top:10,zIndex:1e3,cursor:"pointer"}).click(handlerClick),anima.play(),stage.scaleX=getScale(),stage.scaleY=stage.scaleX,anima.obj.mouseenter(function(){anima.play(),anima.obj.attr({width:130*stage.scaleX,height:130*stage.scaleY}).addClass("btnRev")})}),$("<div>").addClass("revela").attr("data-revela",i).html(data).css({width:"100%",height:"auto",padding:5,margin:"130px 0 0 -5px",background:"linear-gradient(to bottom, #fff, #eee)",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.3)",textShadow:"1px 1px 2px rgba(0, 0, 0, 0.3)",textAlign:config.textAlign,fontSize:config.fontSize,fontWeight:config.fontWeight,color:config.fontColor,borderRadius:5,display:"none"}).appendTo($revelaBox)}),ARR_TAREFAS[tarefarevela_lampada].resolve()}var tarefarevela_lampada=addTarefa(),edi=require("../lib/edi"),_configEDI=null;return{objetivos:[],setConfig:_setConfig,revela_lampada:_init}});